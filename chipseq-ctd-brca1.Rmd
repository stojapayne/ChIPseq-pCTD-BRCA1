---
title: "U2OS BRCA1 RNAPII ChIP"
author: "Aiola Stoja"
date: '2022-12-29'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, results = 'hide')

library(BiocManager)
library(ChIPseeker)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
txdb <- TxDb.Hsapiens.UCSC.hg38.knownGene
library(clusterProfiler)
#library(remotes) ##used to install seqUtils package to use loadNarrowPeaks (below)
#remotes::install_github("kauralasoo/seqUtils")
library(seqUtils)
library(ggpubr)

peakBRCA1 <- loadNarrowPeaks( "U2OS_narrowpeaks", c("U2OSBRCA1etop_callpeaknoabC", 
                                       "U2OSBRCA1nt_callpeaknoabC"),
                peaks_suffix = "_peaks.narrowPeak", 
                sub_dir = FALSE)

peakRNAPII <- loadNarrowPeaks( "U2OS_narrowpeaks",
                               c("U2OSRNAPIIetop_callpeaknoabC","U2OSRNAPIIdmso2_callpeaknoabC"),
                peaks_suffix = "_peaks.narrowPeak", 
                sub_dir = FALSE)
covplotRNAPII <- covplot(peakRNAPII, weightCol="score", chrs=c("chr1", "chr2", "chr3", "chr4", "chr5", "chr6",
                                                               "chr7", "chr8", "chr9", "chr10", "chr11", "chr12",
                                                               "chr13", "chr14", "chr15", "chr16", "chr17",
                                                               "chr18", "chr19", "chr20", "chr21", "chr22",
                                                               "chrX"))

covplotBRCA1 <- covplot(peakBRCA1, weightCol="score", chrs=c("chr1", "chr2", "chr3", "chr4", "chr5", "chr6",
                                                             "chr7", "chr8", "chr9", "chr10", "chr11", "chr12",
                                                             "chr13", "chr14", "chr15", "chr16", "chr17", "chr18",
                                                             "chr19", "chr20", "chr21", "chr22", "chrX", "chrY"))

ggarrange(covplotBRCA1, covplotRNAPII, nrow = 2, ncol = 1)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
